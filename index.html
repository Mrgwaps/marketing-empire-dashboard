<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Marketing Empire Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 100%);
            color: #e0e0e0;
            padding: 20px;
            min-height: 100vh;
        }

        .header {
            text-align: center;
            padding: 30px 0;
            background: rgba(255,255,255,0.02);
            border-radius: 15px;
            margin-bottom: 30px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .header h1 {
            font-size: 2.5em;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .header p {
            color: #888;
            font-size: 0.95em;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: rgba(255,255,255,0.03);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
            transition: transform 0.2s, border-color 0.2s;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            border-color: rgba(102, 126, 234, 0.5);
        }

        .stat-label {
            color: #888;
            font-size: 0.85em;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 8px;
        }

        .stat-value {
            font-size: 2.2em;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stat-change {
            font-size: 0.85em;
            color: #4ade80;
        }

        .stat-change.negative {
            color: #f87171;
        }

        .chart-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-container {
            background: rgba(255,255,255,0.03);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
        }

        .chart-title {
            font-size: 1.2em;
            margin-bottom: 20px;
            color: #fff;
        }

        .income-streams {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .income-stream {
            background: rgba(255,255,255,0.03);
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid;
        }

        .income-stream.amazon { border-left-color: #ff9900; }
        .income-stream.payhip { border-left-color: #667eea; }
        .income-stream.leads { border-left-color: #4ade80; }
        .income-stream.video { border-left-color: #f87171; }
        .income-stream.reddit { border-left-color: #ff4500; }

        .stream-name {
            font-size: 0.9em;
            color: #888;
            margin-bottom: 8px;
        }

        .stream-revenue {
            font-size: 1.8em;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .stream-status {
            font-size: 0.8em;
            padding: 4px 8px;
            border-radius: 4px;
            display: inline-block;
        }

        .stream-status.active {
            background: rgba(74, 222, 128, 0.2);
            color: #4ade80;
        }

        .stream-status.pending {
            background: rgba(251, 191, 36, 0.2);
            color: #fbbf24;
        }

        .milestones {
            background: rgba(255,255,255,0.03);
            padding: 25px;
            border-radius: 12px;
            border: 1px solid rgba(255,255,255,0.1);
            margin-bottom: 30px;
        }

        .milestone-item {
            display: flex;
            align-items: center;
            padding: 15px;
            margin-bottom: 10px;
            background: rgba(255,255,255,0.02);
            border-radius: 8px;
        }

        .milestone-icon {
            font-size: 1.5em;
            margin-right: 15px;
        }

        .milestone-text {
            flex: 1;
        }

        .milestone-progress {
            width: 150px;
            height: 8px;
            background: rgba(255,255,255,0.1);
            border-radius: 4px;
            overflow: hidden;
        }

        .milestone-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s;
        }

        .footer {
            text-align: center;
            padding: 20px;
            color: #666;
            font-size: 0.85em;
        }

        .refresh-indicator {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 10px 20px;
            background: rgba(102, 126, 234, 0.2);
            border-radius: 8px;
            border: 1px solid rgba(102, 126, 234, 0.5);
            font-size: 0.85em;
            display: none;
        }

        .refresh-indicator.active {
            display: block;
        }

        @media (max-width: 768px) {
            .chart-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="refresh-indicator" id="refreshIndicator">üîÑ Updating data...</div>

    <div class="header">
        <h1>üìä Marketing Empire Dashboard</h1>
        <p>Real-time analytics ‚Ä¢ Last updated: <span id="lastUpdate">--</span></p>
    </div>

    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-label">Total Revenue</div>
            <div class="stat-value" id="totalRevenue">$0.00</div>
            <div class="stat-change" id="revenueChange">--</div>
        </div>

        <div class="stat-card">
            <div class="stat-label">Email Subscribers</div>
            <div class="stat-value" id="totalSubscribers">0</div>
            <div class="stat-change" id="subscriberChange">--</div>
        </div>

        <div class="stat-card">
            <div class="stat-label">Total Content</div>
            <div class="stat-value" id="totalContent">0</div>
            <div class="stat-change">Across 5+ platforms</div>
        </div>

        <div class="stat-card">
            <div class="stat-label">API Calls Today</div>
            <div class="stat-value" id="apiCalls">--</div>
            <div class="stat-change" id="apiCost">Est. cost: $0.00</div>
        </div>
    </div>

    <h2 style="margin: 30px 0 15px 0; color: #fff;">üí∞ Income Streams</h2>
    <div class="income-streams">
        <div class="income-stream amazon">
            <div class="stream-name">Amazon Associates</div>
            <div class="stream-revenue" id="amazonRevenue">$0.00</div>
            <span class="stream-status pending">Pending API</span>
        </div>

        <div class="income-stream payhip">
            <div class="stream-name">Payhip Products</div>
            <div class="stream-revenue" id="payhipRevenue">$0.00</div>
            <span class="stream-status pending">Pending API</span>
        </div>

        <div class="income-stream leads">
            <div class="stream-name">Lead Generation</div>
            <div class="stream-revenue" id="leadRevenue">$0.00</div>
            <span class="stream-status pending">Pending Setup</span>
        </div>

        <div class="income-stream video">
            <div class="stream-name">Video Content</div>
            <div class="stream-revenue" id="videoRevenue">$0.00</div>
            <span class="stream-status pending">Pending API</span>
        </div>

        <div class="income-stream reddit">
            <div class="stream-name">Reddit Affiliate</div>
            <div class="stream-revenue" id="redditRevenue">$0.00</div>
            <span class="stream-status active">Active</span>
        </div>
    </div>

    <div class="chart-grid">
        <div class="chart-container">
            <div class="chart-title">üìà Revenue Trend (7 Days)</div>
            <canvas id="revenueChart"></canvas>
        </div>

        <div class="chart-container">
            <div class="chart-title">üë• Email Growth</div>
            <canvas id="subscriberChart"></canvas>
        </div>

        <div class="chart-container">
            <div class="chart-title">üìù Content Distribution</div>
            <canvas id="contentChart"></canvas>
        </div>

        <div class="chart-container">
            <div class="chart-title">üîó Traffic Sources</div>
            <canvas id="trafficChart"></canvas>
        </div>
    </div>

    <div class="milestones">
        <h2 style="margin-bottom: 20px; color: #fff;">üéØ Milestones</h2>
        <div class="milestone-item">
            <div class="milestone-icon">üìß</div>
            <div class="milestone-text">
                <div style="font-weight: 600;">First 10 Subscribers</div>
                <div style="font-size: 0.85em; color: #888;">0 / 10 subscribers</div>
            </div>
            <div class="milestone-progress">
                <div class="milestone-progress-bar" style="width: 0%"></div>
            </div>
        </div>

        <div class="milestone-item">
            <div class="milestone-icon">üí∞</div>
            <div class="milestone-text">
                <div style="font-weight: 600;">First Dollar Earned</div>
                <div style="font-size: 0.85em; color: #888;">$0.00 / $1.00</div>
            </div>
            <div class="milestone-progress">
                <div class="milestone-progress-bar" style="width: 0%"></div>
            </div>
        </div>

        <div class="milestone-item">
            <div class="milestone-icon">üì±</div>
            <div class="milestone-text">
                <div style="font-weight: 600;">30 Pieces of Content</div>
                <div style="font-size: 0.85em; color: #888;">0 / 30 posts created</div>
            </div>
            <div class="milestone-progress">
                <div class="milestone-progress-bar" style="width: 0%"></div>
            </div>
        </div>
    </div>

    <div class="footer">
        <p>üöÄ Built with Composio ‚Ä¢ Powered by Airtable API ‚Ä¢ Auto-refreshes every 5 minutes</p>
        <p style="margin-top: 10px;">Amazon Associates (AKPA22X69E1756285391) ‚Ä¢ Payhip ‚Ä¢ AgentMail ‚Ä¢ KIE AI ‚Ä¢ Hyperbrowser</p>
    </div>

    <script>
        // Airtable Configuration - REPLACE WITH YOUR AIRTABLE PERSONAL ACCESS TOKEN
        const AIRTABLE_CONFIG = {
            baseId: 'appl6ToZSGjS6wU0K',
            token: 'YOUR_AIRTABLE_PAT_HERE', // User needs to add their PAT
            tables: {
                productPerformance: 'tblshfGxKJYZEWyU6',
                redditPerformance: 'tblNdvMYw7aelx59Z',
                emailMetrics: 'tblkXDs74AhSD4N4T',
                payhipSales: 'tblyhdyhkztxZl1S2',
                multiPlatform: 'tble1c4g47GgAWa7j',
                videoPerformance: 'tblt4ZKWfyFrOJO0M'
            }
        };

        // Chart instances
        let revenueChart, subscriberChart, contentChart, trafficChart;

        // Initialize charts
        function initCharts() {
            const chartOptions = {
                responsive: true,
                maintainAspectRatio: true,
                plugins: {
                    legend: {
                        labels: { color: '#e0e0e0' }
                    }
                },
                scales: {
                    y: {
                        ticks: { color: '#888' },
                        grid: { color: 'rgba(255,255,255,0.1)' }
                    },
                    x: {
                        ticks: { color: '#888' },
                        grid: { color: 'rgba(255,255,255,0.1)' }
                    }
                }
            };

            // Revenue Chart
            revenueChart = new Chart(document.getElementById('revenueChart'), {
                type: 'line',
                data: {
                    labels: ['Day 1', 'Day 2', 'Day 3', 'Day 4', 'Day 5', 'Day 6', 'Day 7'],
                    datasets: [{
                        label: 'Revenue ($)',
                        data: [0, 0, 0, 0, 0, 0, 0],
                        borderColor: '#667eea',
                        backgroundColor: 'rgba(102, 126, 234, 0.1)',
                        tension: 0.4,
                        fill: true
                    }]
                },
                options: chartOptions
            });

            // Subscriber Chart
            subscriberChart = new Chart(document.getElementById('subscriberChart'), {
                type: 'bar',
                data: {
                    labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                    datasets: [{
                        label: 'New Subscribers',
                        data: [0, 0, 0, 0],
                        backgroundColor: 'rgba(74, 222, 128, 0.6)',
                        borderColor: '#4ade80',
                        borderWidth: 1
                    }]
                },
                options: chartOptions
            });

            // Content Distribution Chart
            contentChart = new Chart(document.getElementById('contentChart'), {
                type: 'doughnut',
                data: {
                    labels: ['Reddit', 'Quora', 'Medium', 'YouTube', 'Craigslist'],
                    datasets: [{
                        data: [0, 0, 0, 0, 0],
                        backgroundColor: [
                            '#ff4500',
                            '#b92b27',
                            '#00ab6c',
                            '#ff0000',
                            '#8b5cf6'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: { color: '#e0e0e0' }
                        }
                    }
                }
            });

            // Traffic Sources Chart
            trafficChart = new Chart(document.getElementById('trafficChart'), {
                type: 'pie',
                data: {
                    labels: ['Reddit', 'Direct', 'Other'],
                    datasets: [{
                        data: [0, 0, 0],
                        backgroundColor: [
                            '#ff4500',
                            '#667eea',
                            '#888'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        legend: {
                            labels: { color: '#e0e0e0' }
                        }
                    }
                }
            });
        }

        // Fetch data from Airtable
        async function fetchAirtableData() {
            if (AIRTABLE_CONFIG.token === 'YOUR_AIRTABLE_PAT_HERE') {
                console.log('Please add your Airtable Personal Access Token to the dashboard');
                return;
            }

            const indicator = document.getElementById('refreshIndicator');
            indicator.classList.add('active');

            try {
                // Fetch Product Performance
                const productResponse = await fetch(
                    `https://api.airtable.com/v0/${AIRTABLE_CONFIG.baseId}/${AIRTABLE_CONFIG.tables.productPerformance}`,
                    {
                        headers: {
                            'Authorization': `Bearer ${AIRTABLE_CONFIG.token}`
                        }
                    }
                );
                const productData = await productResponse.json();

                // Fetch Email Metrics
                const emailResponse = await fetch(
                    `https://api.airtable.com/v0/${AIRTABLE_CONFIG.baseId}/${AIRTABLE_CONFIG.tables.emailMetrics}`,
                    {
                        headers: {
                            'Authorization': `Bearer ${AIRTABLE_CONFIG.token}`
                        }
                    }
                );
                const emailData = await emailResponse.json();

                // Update dashboard with real data
                updateDashboard(productData, emailData);

            } catch (error) {
                console.error('Error fetching Airtable data:', error);
            } finally {
                indicator.classList.remove('active');
                document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString();
            }
        }

        // Update dashboard with fetched data
        function updateDashboard(productData, emailData) {
            // Calculate total revenue
            let totalRevenue = 0;
            if (productData.records) {
                productData.records.forEach(record => {
                    totalRevenue += parseFloat(record.fields.Revenue || 0);
                });
            }
            document.getElementById('totalRevenue').textContent = `$${totalRevenue.toFixed(2)}`;

            // Calculate total subscribers
            let totalSubscribers = 0;
            if (emailData.records) {
                emailData.records.forEach(record => {
                    totalSubscribers += parseInt(record.fields['Email Signups'] || 0);
                });
            }
            document.getElementById('totalSubscribers').textContent = totalSubscribers;

            // Update charts with real data
            // (Chart update logic would go here based on actual data structure)
        }

        // Initialize dashboard
        document.addEventListener('DOMContentLoaded', function() {
            initCharts();
            fetchAirtableData();

            // Auto-refresh every 5 minutes
            setInterval(fetchAirtableData, 5 * 60 * 1000);
        });
    </script>
</body>
</html>